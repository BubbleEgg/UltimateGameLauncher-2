<div id="users">
    <div class="u-display">
        <div class="u-name">mindestorm</div>
        <div class="u-btn-switch" onclick="window.changeUserNew('mindestorm')">Wechseln</div>
    </div>
    <div class="u-display">
        <div class="u-name">bubbleegg2</div>
        <div class="u-btn-switch" onclick="window.changeUserNew('bubbleegg2')">Wechseln</div>
    </div>
</div>

<script>
    window.changeUserNew = async function(name){
        var running = await isRunning();
        if(running){
            window.closeSteam();
            await timeout(2000);
        }
        var Registry = require('winreg')
        ,   regKey = new Registry({
            hive: Registry.HKCU,
            key:  '\\Software\\Valve\\Steam'
        });
        regKey.set('AutoLoginUser', Registry.REG_SZ, name, function() {
            window.openSteam();
        });
    }

    window.closeSteam = function (){
        var executablePath = "\"D:\\Program Files (x86)\\Steam\\Steam.exe\" -shutdown";
        const { exec } = require('child_process');
        exec(executablePath, (error, stdout, stderr) => {
            
        });
    }

    window.openSteam = function (){
        var executablePath = "\"D:\\Program Files (x86)\\Steam\\Steam.exe\"";
        const { exec } = require('child_process');
        exec(executablePath, (error, stdout, stderr) => {
            
        });
    }
</script>